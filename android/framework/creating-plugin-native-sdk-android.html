---
title: 'Création d'un plugin pour le SDK natif pour Android' la
description: Dans cette rubrique, vous apprendrez à créer un plugin pour le SDK natif pour Android.
parent: Framework 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">Aperçu</h2>

<p>À un niveau élevé, un plugin s'intègre au lecteur en écoutant et en émettant des événements. Un plugin peut écouter les événements du lecteur et d'autres plugins. Un plugin peut émettre des événements pour le lecteur et pour d'autres plugins.</p>

<p>Ce contenu ainsi que l'exemple de code se trouvent à l'adresse <a href="https://github.com/BrightcoveOS/android-plugin-guide">https://github.com/BrightcoveOS/android-plugin-guide</a></p>
</section>

<section class="bcls-section">
<h2 id="Plugin_architecture">Architecture des plugins</h2>

<div class="BCL-concept">
<p>Un plugin doit s'enregistrer auprès du SDK lorsqu'il est instancié. Pour enregistrer un plugin doit émettre un <code translate="No">REGISTER_PLUGIN</code> événement avec un <code translate="No">PLUGIN_NAME</code> biens. Par exemple:</p>

<pre class="line-numbers">
  <code class="language-java" translate="No">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();
  properties.put(Event.PLUGIN_NAME, "my custom plugin");
  eventEmitter.emit(EventType.REGISTER_PLUGIN, properties);</code></pre>

<p>La lecture vidéo passe généralement par un flux d'événements de cycle de vie standard :</p>

<figure class="bcls-figure"><img class="bcls-image" alt="Plugin event flow" src="/assets/images/android/framework/plugin-event-flow.png" />
<figcaption class="bcls-caption--image">Flux d'événements de plug-in</figcaption>
</figure>
</div>
</section>

<section class="bcls-section">
<h2 id="Event_details">Détails de l'évènement</h2>

<div class="BCL-concept">
<p>Un plugin peut écouter les événements, qui initient une action, afin de changer le comportement par défaut du lecteur. Ces événements comprennent :</p>

<ol>
	<li><code translate="No">WILL_CHANGE_VIDEO</code></li>
	<li><code translate="No">SET_VIDEO</code></li>
	<li><code translate="No">SET_SOURCE</code></li>
	<li><code translate="No">PLAY</code></li>
	<li><code translate="No">PAUSE</code></li>
	<li><code translate="No">SEEK_TO</code></li>
	<li><code translate="No">STOP</code></li>
</ol>

<p>Le comportement par défaut peut être modifié en empêchant les écouteurs par défaut de recevoir l'événement et/ou en arrêtant la propagation de l'événement aux écouteurs autres que ceux par défaut. Empêcher les écouteurs par défaut de recevoir l'événement est accompli en appelant le <code translate="No">preventDefault()</code> méthode. La propagation de l'événement peut être arrêtée en appelant le <code translate="No">stopPropagation()</code> méthode. Si seulement <code translate="No">preventDefault()</code> est appelé, le reste des auditeurs autres que ceux par défaut seront notifiés. Si seulement <code translate="No">stopPropagation()</code> est appelé, les écouteurs par défaut seront toujours notifiés, mais le reste des écouteurs autres que ceux par défaut seront ignorés. Un plugin peut également utiliser ces méthodes pour suspendre le flux d'événements normal et insérer un comportement supplémentaire, comme l'initialisation du plugin. Un plugin peut reprendre le flux d'événements en émettant à nouveau l'événement d'origine.</p>

<p>Un plugin peut également écouter les événements, qui signalent la fin d'une action. Ces événements sont généralement utilisés par les plug-ins d'analyse. Les événements comprennent :</p>

<ol>
	<li><code translate="No">DID_CHANGE_LIST</code></li>
	<li><code translate="No">DID_SELECT_SOURCE</code></li>
	<li><code translate="No">DID_PAUSE</code></li>
	<li><code translate="No">DID_PLAY</code></li>
	<li><code translate="No">DID_SEEK_TO</code></li>
	<li><code translate="No">DID_SET_SOURCE</code></li>
	<li><code translate="No">DID_STOP</code></li>
	<li><code translate="No">PROGRESS</code></li>
	<li><code translate="No">COMPLETED</code></li>
</ol>
</div>
</section>

<section class="bcls-section">
<h2 id="Interrupt_playback">Interrompre la lecture</h2>

<div class="BCL-concept">
<p>Un plugin, qui souhaite interrompre la lecture du contenu vidéo, doit utiliser <code translate="No">WILL_INTERRUPT_CONTENT</code> et <code translate="No">WILL_RESUME_CONTENT</code>. Ces événements sont généralement utilisés par les plugins publicitaires. Un plugin doit émettre <code translate="No">WILL_INTERRUPT_CONTENT</code> pour demander que la lecture soit suspendue, si elle est en cours de lecture, et pour demander que la vue vidéo soit rendue invisible. Un plugin doit émettre <code translate="No">WILL_RESUME_CONTENT</code> pour demander que la vue vidéo soit à nouveau visible. Les <code translate="No">WILL_RESUME_CONTENT</code> l'événement devrait inclure un <code translate="No">ORIGINAL_EVENT</code> propriété qui sera émise après que la vue vidéo soit rendue visible. Les <code translate="No">ORIGINAL_EVENT</code> devrait être un <code translate="No">PLAY</code> événement pour reprendre la lecture, un <code translate="No">CUE_POINT</code> événement pour continuer le traitement des points de repère, ou un <code translate="No">COMPLETED</code> événement pour terminer la lecture. UNE <code translate="No">SKIP_CUE_POINTS</code> la propriété doit être ajoutée à la <code translate="No">ORIGINAL_EVENT</code> pour empêcher le traitement récursif des points de repère.</p>
</div>
</section>

<section class="bcls-section">
<h2 id="Cue_points">Points de repère</h2>

<div class="BCL-concept">
<p>De nombreux plugins voudront écouter <code translate="No">CUE_POINT</code> événements. Il existe trois types de points de repère, <code translate="No">BEFORE</code> , <code translate="No">POINT_IN_TIME</code> , et <code translate="No">AFTER</code> . <code translate="No">BEFORE</code> les points de repère sont émis juste avant le début de la lecture. <code translate="No">POINT_IN_TIME</code> des points de repère sont émis lorsque la lecture atteint la position du point de repère. <code translate="No">AFTER</code> les points de repère sont émis juste après la fin de la lecture. Un plugin doit utiliser <code translate="No">WILL_INTERRUPT_CONTENT</code> et <code translate="No">WILL_RESUME_CONTENT</code> événements pour interrompre et reprendre la lecture du contenu lors de la gestion d'un événement de point de repère. Dans le cas des points de repère avant et après, l'événement comprendra un <code translate="No">ORIGINAL_EVENT</code> propriété, avec soit un <code translate="No">PLAY</code> événement ou un <code translate="No">COMPLETED</code> un événement. Les événements de point de repère incluent également un <code translate="No">CUE_POINTS</code> propriété avec le lot de points de repère. <code translate="No">START_TIME</code> et <code translate="No">END_TIME</code> Les propriétés définissent la plage de temps du point de repère.</p>
</div>
</section>

<section class="bcls-section">
<h2 id="Sample_directory">Exemple de répertoire</h2>

<div class="BCL-concept">
<p>Les <a href="https://github.com/BrightcoveOS/android-plugin-guide/tree/master/sample">exemple de répertoire</a> comprend un projet basé sur Android Studio avec deux modules :</p>

<ul>
	<li><strong>SamplePlugin</strong> - Un exemple de plugin, qui peut être utilisé comme base pour écrire de nouveaux plugins.</li>
	<li><strong>Exemple d'application de plug-in</strong> - Montre comment les plugins sont incorporés dans une application vidéo Brightcove et peuvent être utilisés pour tester le SamplePlugin ou de nouveaux plugins.</li>
</ul>
</div>
</section>

<section class="bcls-section">
<h2 id="Implementation_steps">Étapes de mise en œuvre</h2>

<div class="BCL-concept">
<p>Les étapes pour écrire un plugin incluent :</p>

<ol>
	<li>Copiez l'exemple de plug-in dans un nouveau référentiel.</li>
	<li>Modifiez les noms de package et de classe.</li>
	<li>Mettre à jour le <code translate="No">TAG</code> initialiseur.</li>
	<li>Modifier le <code translate="No">@Emits</code> et <code translate="No">@ListensFor</code> annotations pour refléter les événements que le plugin émet et écoute.</li>
	<li>Modifiez le constructeur si nécessaire.</li>
	<li>Remplacez ou retirez le <code translate="No">videoView</code> logique connexe si nécessaire.</li>
	<li>Modifier <code translate="No">initializeListeners()</code> en ajoutant et/ou en soustrayant des écouteurs d'événement si nécessaire.</li>
	<li>Compilez et distribuez votre plugin en tant que <strong>.aar</strong> fichier pour Android Studio.</li>
	<!--                <li>Compile and distribute your plugin as a .jar file for Eclipse and/or an .aar file for Android Studio.</li>-->
</ol>
</div>
</section>
</article>