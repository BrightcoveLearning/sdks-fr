---
title: 'Sélection de sous-titres par programmation avec le SDK natif pour Android' la
description: Dans cette rubrique, vous apprendrez à sélectionner par programmation des sous-titres lors de l'utilisation du Brightcove Native SDK pour Android.
parent: Captions 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>


<section class="bcls-section">
  <h2 id="Overview">Aperçu</h2>
  <p>
    Le SDK natif pour Android reçoit des sous-titres de l'un des éléments suivants :
  </p>
  <ul>
    <li>Réponse du catalogue Brightcove (API de lecture) : Sidecar WebVTT</li>
    <li>Manifeste vidéo (HLS ou DASH) : WebVTT dans le manifeste</li>
  </ul>
  <p>
    Pour plus d'informations sur les sous-titres, consultez le <a href="https://sdks.support.brightcove.com/features/using-captions-brightcove-native-sdks.html">Utilisation des sous-titres avec les SDK natifs Brightcove</a> document.
  </p>
</section>

<section class="bcls-section">
  <h2 id="Event_sequence">Séquence d'événements</h2>
  <p>
    Le SDK natif suit cette séquence d'événements associée aux sous-titres :
  </p>
  <ol class="bcls-tasklist">
    <li>
      <p>
        Récupérez une vidéo du catalogue Brightcove (c. <code translate="No">catalog.findVideoByID()</code>).
      </p>
    </li>
    <li>
      <p>
        Les sous-titres annexes sont analysés à partir de la réponse du catalogue et ajoutés aux propriétés de la vidéo.
      </p>
    </li>
    <li>
      <p>
        À ce stade, vous pouvez récupérer les sources de sous-titres comme suit :
      </p>
      <pre><code class="language-java" translate="No">video.getProperties().get(Video.Fields.CAPTION_SOURCES);</code></pre>
    </li>
    <li>
      <p>
        Définissez la vue vidéo. La vidéo est ajoutée à ExoPlayer.
      </p>
      <pre><code class="language-java" translate="No">brightcoveVideoView.add(video);</code></pre>
    </li>
    <li>
      <p>
        Le SDK natif obtient les sources de sous-titres et émet l'événement suivant :
      </p>
      <pre><code class="language-java" translate="No">EventType.CAPTIONS_LANGUAGES</code></pre>
    </li>
    <li>
      <p>
        Une fois la vidéo ajoutée à ExoPlayer, le SDK natif recherche les sous-titres dans le manifeste. Les sous-titres qui ne sont pas déjà présents dans les sources de sous-titres vidéo sont ajoutés. S'il existe de nouvelles sources de sous-titres, l'événement suivant est envoyé pour mettre à jour le contrôleur multimédia Brightcove.
      </p>
      <pre><code class="language-java" translate="No">EventType.CAPTIONS_LANGUAGES</code></pre>
    </li>
  </ol>
</section>

<section class="bcls-section">
  <h2 id="Select_captions">Sélectionnez les légendes</h2>
  <p>
    Suivez ces étapes pour sélectionner des sous-titres par programmation :
  </p>
  <ol class="bcls-tasklist__restart">
    <li>
      <p>
        Créez une méthode pour trouver une source de sous-titres spécifique avec le code de langue. Par exemple:
      </p>
      <pre><code class="language-java" translate="No">private Pair&lt;Uri, BrightcoveCaptionFormat&gt; getCaptionsForLanguageCode(Video video, String languageCode) {
 Object payload = video == null ? null : video.getProperties().get(Video.Fields.CAPTION_SOURCES);

if (payload instanceof List) {
 @SuppressWarnings(&quot;unchecked&quot;)
 List&lt;Pair&lt;Uri, BrightcoveCaptionFormat&gt;&gt; pairs =
    (List&lt;Pair&lt;Uri, BrightcoveCaptionFormat&gt;&gt;) payload;

 for (Pair&lt;Uri, BrightcoveCaptionFormat&gt; pair : pairs) {
   if (pair.second.language().equals(languageCode)) {
     return pair;
   }
 }
}
return null;
}</code></pre>
    </li>
    <li>
      <p>
        Notez que les sources de sous-titres sont dans <code translate="No">Pair&lt;Uri, BrightcoveCaptionFormat&gt;</code>. Les <code translate="No">Uri</code> dans la paire indique le type sous-titres codés :
      </p>
      <ul>
        <li>
          <strong>Side-car</strong>: L'URL complète est présente
        </li>
        <li>
          <strong>Dans le manifeste</strong>: Le BrightcoveCaptionFormat.BRIGHTCOVE_SCHEME est utilisé
        </li>
      </ul>
    </li>
    <li>
      <p>
        Créer une méthode chargée de sélectionner les sous-titres d'une vidéo avec un code de langue donné, en émettant le <code translate="No">EventType.SELECT_CLOSED_CAPTION_TRACK</code> un événement.
      </p>
      <pre><code class="language-java" translate="No">private void selectCaption(Video video, String language) {
 Pair&lt;Uri, BrightcoveCaptionFormat&gt; pair = getCaptionsForLanguageCode(video, language);

if (pair != null &amp;&amp; !pair.first.equals(Uri.EMPTY)) {
 // BrightcoveCaptionFormat.BRIGHTCOVE_SCHEME indicates that is not a URL we need to load with the LoadCaptionsService, but instead we'll be enabled through a different component.
 if (!pair.first.toString().startsWith(BrightcoveCaptionFormat.BRIGHTCOVE_SCHEME)) {
   brightcoveVideoView.getClosedCaptioningController().getLoadCaptionsService().loadCaptions(pair.first, pair.second.type());
 }
 Map&lt;String, Object&gt; properties = new HashMap&lt;&gt;();
 properties.put(Event.CAPTION_FORMAT, pair.second);
 properties.put(Event.CAPTION_URI, pair.first);
 brightcoveVideoView.getEventEmitter().emit(EventType.SELECT_CLOSED_CAPTION_TRACK, properties);
}
}</code></pre>
    </li>
    <li>
      <p>
        Écouter le <code translate="No">EventType.CAPTIONS_LANGUAGES</code> événement et sélectionnez la langue souhaitée par le code de langue.
      </p>
      <pre><code class="language-java" translate="No">brightcoveVideoView.getEventEmitter().once(EventType.CAPTIONS_LANGUAGES, new EventListener() {
@Override
public void processEvent(Event event) {
 brightcoveVideoView.setClosedCaptioningEnabled(true);

  // You could find the desired languaged in the LANGUAGES list.
  // List&lt;String&gt; languages = event.getProperty(Event.LANGUAGES, List.class);
 selectCaption(brightcoveVideoView.getCurrentVideo(), &quot;ja&quot;);
}
});</code></pre>
    </li>

  </ol>
</section>

</article>