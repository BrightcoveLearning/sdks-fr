<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Référence Brightcove Native Player pour iOS</title>

	<link rel="stylesheet" href="css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title"> <a href="index.html">Lecteur natif Brightcove pour iOS </a> </h1>

			<p id="developer-home">
				Brightcove<a href="index.html"></a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="hierarchy.html">Hiérarchie</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">Référence Brightcove Native Player pour iOS</h1>

					
					<div class="section section-overview index-overview">
						
						
						<h1>Plugin IMA pour Brightcove Player SDK pour iOS, version 6.9.0.1697</h1> <h1>Conditions</h1>

<ul>
<li>Xcode 11.0+</li>
<li>ARC</li>
</ul>


<h1>Plateformes prises en charge</h1>

<p>iOS 11.0 et supérieur.</p>

Installation<h1></h1>

<p>Le plug-in IMA pour Brightcove Player SDK fournit un cadre de bibliothèque dynamique pour l'installation.</p>

<p>Le plug-in IMA prend en charge la version 3.12.1 du SDK Google IMA pour iOS et la version 4.3.2 du SDK Google IMA pour tvOS.</p>

<h2>CocoaPods</h2>

<p>Vous pouvez utiliser <a href="http://cocoapods.org">CocoaPods</a> pour ajouter le plug-in IMA pour Brightcove Player SDK à votre projet. Vous pouvez trouver les dernières <code>Brightcove-Player-IMA</code> podspec <a href="https://github.com/brightcove/BrightcoveSpecs/tree/master/Brightcove-Player-IMA">ici</a>. Le pod incorporera automatiquement la version correcte d'IMA. CocoaPods 1.0 ou plus récent est requis.</p>

<p>Exemple de Podfile CocoaPod :</p>

<pre><code>source 'https://github.com/brightcove/BrightcoveSpecs.git' use_frameworks ! plateforme :ios, '11.0' cible 'MyIMAPlayer' do pod 'Brightcove-Player-IMA' finir </code></pre>

<p>Depuis la version IMA 3.4.1, AdMob est publié en tant que framework dynamique autonome et ne peut plus être installé dans le cadre du plug-in IMA pour le Brightcove Native Player SDK. En tant que tel, il n'y a plus de <code>PourAdMob</code> sous-spécification pour le podspec. Pour utiliser AdMob, téléchargez-le et ajoutez-le à votre projet manuellement, ou ajoutez le <code>Google-Mobile-Ads-SDK</code> CocoaPod dans votre Podfile :</p>

<pre><code>pod 'Google-Mobile-Ads-SDK' </code></pre>

<p>Lors de la mise à jour de votre installation, il&rsquo;C'est une bonne idée d'actualiser la copie locale de votre référentiel BrightcoveSpecs afin que vous disposiez des derniers podspecs localement, tout comme vous mettriez à jour votre référentiel maître CococaPods.</p>

<p>Généralement si vous utilisez <code>mise à jour du pod</code> dans Terminal, cela se produira automatiquement, ou vous pouvez également mettre à jour explicitement avec <code>pod repo mise à jour brightcove</code>. (Votre référentiel BrightcoveSpecs peut avoir un nom différent si vous l'avez explicitement ajouté à votre liste de référentiels podspecs.)</p>

<h2>Manuel</h2>

<p>Pour ajouter manuellement le plug-in IMA pour Brightcove Player SDK à votre projet :</p>

<ol>
<li>Téléchargez le <a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">Kit de développement logiciel Brightcove Player</a> cadre.</li>
<li>Téléchargez le <a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/releases">Plugin IMA pour Brightcove Player SDK</a> cadre.</li>
<li>Téléchargez le <a href="https://developers.google.com/interactive-media-ads/docs/sdks/ios/download">Google IMA</a> cadre.</li>
<li>Sur le &ldquo;Général&rdquo; onglet de votre application cible, ajoutez le <strong>dynamique</strong> framework, BrightcovePlayerSDK.framework, du téléchargement du Brightcove Player SDK à la liste des <strong>Frameworks, bibliothèques, contenu intégré</strong>. Le framework dynamique, BrightcovePlayerSDK.framework, se trouve dans le répertoire ios/dynamic du téléchargement.</li>
<li>Sur le &ldquo;Général&rdquo; onglet de votre application cible, ajoutez BrightcoveIMA.framework à partir du téléchargement du plug-in IMA pour Brightcove Player SDK à la liste des <strong>Frameworks, bibliothèques, contenu intégré</strong>.</li>
<li>Sur le &ldquo;Général&rdquo; onglet de votre application cible, ajoutez GoogleInteractiveMediaAds.framework du téléchargement Google IMA à la liste des <strong>Frameworks, bibliothèques, contenu intégré</strong>.</li>
<li>Sur le &ldquo;Paramètres de construction&rdquo; de l'onglet cible de votre application, assurez-vous que le &ldquo;Chemins de recherche du framework&rdquo; inclure les chemins vers les cadres. Cela aurait dû être fait automatiquement à moins que le framework ne soit stocké dans un répertoire racine différent de celui de votre projet.</li>
<li>Sur le &ldquo;Paramètres de construction&rdquo; onglet de votre application cible :

<ul>
<li>Veiller à ce que <code>-ObjC</code> a été ajouté au &ldquo;Autres indicateurs de liens&rdquo; paramètre de construction.</li>
</ul>
</li>
</ol>


<h2>Importations</h2>

<p>Le plug-in IMA pour Brightcove Player SDK peut être importé dans le code de différentes manières ; <code>@import BrightcoveIMA;</code> , <code>#import &lt;BrightcoveIMA/BrightcoveIMA.h&gt;</code> ou <code>#import &lt;BrightcoveIMA/[classe spécifique].h&gt;</code>. Vous pouvez importer le <code>Annonces GoogleInteractiveMedia</code> et <code>BrightcovePlayerSDK</code> modules de manière similaire.</p>

<h1>Démarrage rapide</h1>

<p>Le plugin BrightcoveIMA est un pont entre <a href="https://developers.google.com/interactive-media-ads/docs/sdks/ios/download">SDK Google IMA iOS v3</a> et le <a href="https://github.com/brightcove/brightcove-player-sdk-ios">Kit de développement logiciel Brightcove Player pour iOS</a>. Cet extrait montre son utilisation de base avec les règles publicitaires VMAP.</p>

<pre><code>[1] IMASettings *imaSettings = [[IMASettings alloc] init]; imaSettings.ppid = kViewControllerIMAPublisherID; imaSettings.language = kViewControllerIMALanguage; IMAAdsRenderingSettings *renderSettings = [[IMAAdsRenderingSettings alloc] init]; renderSettings.webOpenerPresentingController = self; UIView *videoContainerView = &lt;UIView du conteneur vidéo&gt; ; NSString *adTag = &lt;tag publicitaire&gt; ; [2] BCOVIMAAdsRequestPolicy *adsRequestPolicy = [BCOVIMAAdsRequestPolicy adsRequestPolicyWithVMAPAdTagUrl:adTag] ; BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManagersharedManager] ; id&lt;BCOVPlaybackController&gt; controller = [3] [manager createIMAPlaybackControllerWithSettings:imaSettings adsRenderingSettings:renderSettings adsRequestPolicy:adsRequestPolicy adContainer:videoContainerView viewController:self compagnonSlots:nil viewStrategy:nil] ; contrôleur.delegate = self; [videoContainerView addSubview:controller.view] ; NSString *policyKey = &lt;votre-clé-politique&gt; ; NSString *accountId = &lt;your-account-id&gt;; NSString *videoID = &lt;votre-vidéo-id&gt; ; BCOVPlaybackService *playbackService = [[BCOVPlaybackService alloc] initWithAccountId:accountID policyKey:policyKey]; [playbackService findVideoWithVideoID:videoID parameters:nil achèvement:^(BCOVVideo *video, NSDictionary *jsonResponse, NSError *error) { [controller setVideos:@[ video ]]; [controller play]; } ; </code></pre>

<p>Décomposer le code en étapes :</p>

<ol>
<li>Créez les mêmes paramètres IMA, les paramètres de rendu des annonces que vous créeriez si vous utilisiez Google&rsquo;s IMA iOS SDK directement. Ceux-ci sont obligatoires.</li>
<li><a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolitique</a> fournit des méthodes pour spécifier des règles publicitaires VAST ou VMAP. Sélectionnez la méthode appropriée pour sélectionner votre politique relative aux annonces.</li>
<li>BrightcoveIMA ajoute quelques méthodes de catégorie à BCOVPlaybackManager. Le premier d'entre eux est <code>-createIMAPlaybackControllerWithSettings:adsRenderingSettings:adsRequestPolicy:adContainer:companionSlots:viewStrategy :</code>. Utilisez cette méthode pour créer votre contrôleur de lecture.</li>
</ol>


<h1>Lecture et pause</h1>

<p>Le plugin Brightcove IMA implémente une logique de lecture et de pause personnalisée pour garantir l'expérience publicitaire la plus fluide possible. Par conséquent, vous devrez vous assurer que vous utilisez la méthode de lecture sur le <code>Contrôleur de lecture BCOV</code> ou la <code>[BCOVSessionProviderExtension ima_play]</code> ou <code>[BCOVSessionProviderExtension ima_pause]</code> (<a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/blob/master/ios/BrightcoveIMA.framework/Headers/BCOVIMAComponent.h">BCOVSessionProviderExtension</a>), et non l'AVPlayer.</p>

<p>Par exemple, appeler play pour la première fois sur <code>Contrôleur de lecture BCOV</code> permet à BCOVIMA de traiter les annonces preroll sans qu'aucun contenu ne soit lu avant le preroll. Pour plus d'informations sur la façon dont BCOVIMA remplace la valeur par défaut <code>Contrôleur de lecture BCOV</code> méthodes, s'il vous plaît vérifier <a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/blob/master/ios/BrightcoveIMA.framework/Headers/BCOVIMAComponent.h">BCOVSessionProviderExtension</a>.</p>

<h1>Utilisation du PlayerUI intégré</h1>

<p>Dans ton <code>UIViewController</code> , créer un <code>BCOVPUIPlayerView</code> propriété appelée la vue du lecteur, pour contenir les commandes de lecture, la vue du contenu vidéo et une vue spéciale où IMA peut afficher ses annonces.</p>

<pre><code>// Vue du joueur de PlayerUI @property (non atomique) BCOVPUIPlayerView *playerView; </code></pre>

<p>Créez ensuite votre vue de joueur ; fournir un contrôleur de lecture nul qui sera ajouté plus tard. Cette vue du lecteur contient à la fois la vue du contenu vidéo et la vue qui affiche les commandes de lecture et les commandes publicitaires. Cette configuration est la même quel que soit le plugin que vous utilisez. Configurez la vue du lecteur pour qu'elle corresponde au conteneur vidéo de votre mise en page (<code>vidéoVoir</code> ) lorsqu'il est redimensionné.</p>

<pre><code>// Créer et configurer la vue de contrôle. BCOVPUIBasicControlView *controlView = [BCOVPUIBasicControlView basicControlViewWithVODLayout]; // Crée la vue du lecteur avec un contrôleur de lecture nil. self.playerView = [[BCOVPUIPlayerView alloc] initWithPlaybackController:nil options:nil controlView:controlView]; // Ajoutez BCOVPUIPlayerView à votre vue vidéo. [self.videoView addSubview:self.playerView] ; </code></pre>

<p>Tu&rsquo;Vous devrez configurer la mise en page pour la vue du lecteur, vous pouvez le faire avec la mise en page automatique ou l'ancienne méthode Springs &amp; Struts.</p>

<p><strong>Ressorts et jambes de force</strong> <code> self.playerView.frame = self.videoView.bounds; self.playerView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth; </code></p>

<p><strong>Mise en page automatique</strong> <code> self.playerView.translatesAutoresizingMaskIntoConstraints = NO; [NSLayoutConstraint activateConstraints:@[ [self.playerView.topAnchor ContrainteEqualToAnchor:self.videoView.topAnchor], [self.playerView.rightAnchor ContrainteEqualToAnchor:self.videoView.rightAnchor], [self.playerView.leftAnchor ContrainteEqualToAnchor:self]videoView.leftAnchor , [self.playerView.bottomAnchor ContrainteEqualToAnchor:self.videoView.bottomAnchor], ]] ; </code></p>

<p>La création du contrôleur de lecture est spécifique à IMA. Créez votre contrôleur de lecture comme vous l'avez fait ci-dessus, mais au lieu de votre vue de conteneur vidéo, transmettez le <code>contentOverlayView</code> de la vue du joueur en tant que votre <code>adContainer</code>. Les <code>contentOverlayView</code> est une vue spéciale utilisée pour superposer des vues sur le contenu vidéo principal.</p>

<pre><code>// Crée le contrôleur de lecture. id&lt;BCOVPlaybackController&gt; controller = [manager createIMAPlaybackControllerWithSettings:imaSettings adsRenderingSettings:renderSettings adsRequestPolicy:adsRequestPolicy adContainer:self.playerView.contentOverlayView // vue spéciale pour le contenu publicitaire IMA viewController:self compagnonSlots:nil view]; contrôleur.delegate = self; // Affecte un nouveau contrôleur de lecture à la vue du lecteur. // Ceci associe la session du playerController au PlayerUI. // Vous pouvez conserver cette vue du lecteur et lui assigner de nouveaux // contrôleurs de lecture au fur et à mesure de leur création. self.playerView.playbackController = self.playbackController; </code></pre>

<p>Désormais, lors de la lecture d'une vidéo avec des publicités, vous verrez les commandes PlayerUI lors de la lecture de contenu vidéo, ainsi que des marqueurs publicitaires sur le curseur de la chronologie (annonces VMAP uniquement).</p>

<p>Le PlayerUI est hautement personnalisable. Pour plus d'informations et un exemple de code, veuillez consulter <strong>Dispositions personnalisées</strong> dans le fichier README.md du <a href="https://github.com/brightcove/brightcove-player-sdk-ios">Référentiel Brightcove Native Player SDK</a>.</p>

<h1>Rechercher sans publicité</h1>

<p>Utilisation <code>-[BCOVPlaybackController seekWithoutAds:(CMTime)seekToTimeachèvementHandler:(void (^)(BOOL terminé))complétion]</code> pour reprendre la lecture à une heure précise sans forcer l'utilisateur à regarder les publicités programmées avant <code>chercherVersHeure</code>.</p>

<p>En préparation pour <code>seekWithoutAds:completionHandler :</code> , désactiver <code>lecture automatique</code> lors de la configuration du <code>Contrôleur de lecture BCOV</code>.</p>

<p>Apple recommande d'attendre que l'état d'un AVPlayerItem passe à prêt à jouer avant d'utiliser l'AVPlayerItem. Par conséquent, appelez <code>seekWithoutAds:completionHandler :</code> dans le <code>kBCOVPlaybackSessionLifecycleEventReady</code> gestionnaire de la <code>PlaybackController:playbackSession:didReceiveLifecycleEvent</code> méthode de votre <code>BCOVPlaybackControllerDélégué</code>.</p>

<p>```objective-c - (void)playbackController:(NSObject<BCOVPlaybackController><em>)contrôleur session de lecture :(NSObject<BCOVPlaybackSession></em>)session didReceiveLifecycleEvent:(BCOVPlaybackSessionLifecycleEvent *)lifecycleEvent { if ([kBCOVPlaybackSessionLifecycleEventReady isEqualToString:lifecycleEvent.eventType]) { // self.resumePlayback est une variable d'instance hypothétique utilisée ici à titre d'illustration. if (self.resumePlayback) { __weak typeof (contrôleur) faibleController = contrôleur ;</p>

<pre><code>// rechercher sans diffuser les annonces programmées avant l'heure de recherche, c'est-à-dire reprendre la lecture. [contrôleur seekWithoutAds:CMTimeMake(seekWithoutAdsValue, seekWithoutAdsTimescale)achèvementHandler:^(BOOL terminé) { if (!finished) { NSLog (@"seekWithoutAds failed to finish"); } typeof(contrôleur) strongController = faibleController; if (contrôleur fort) { // fade out the shutter to reveal the player view. strongController.shutterFadeTime = 0.25; strongController.shutter = NO; // turn off seek without ads - especially important if this player is being used with a playlist self.resumePlayback = NO; } }] ; } </code></pre>

<p>  } } ```</p>

<p>Les <code>obturateur</code> et <code>obturateurFadeTime</code> propriétés de la <code>Contrôleur de lecture BCOV</code> peut être utilisé avec <code>seekWithoutAds:completionHandler :</code> pour masquer le scintillement des images qui peut se produire lorsque AVPlayer charge des actifs. Dans votre code de configuration BCOVPlaybackController, activez l'obturateur pour masquer la vue du lecteur :</p>

<p>```objective-c NSObject<BCOVPlaybackController> *contrôleur de lecture ;</p>

<p>  playbackController = [sdkManager createFWPlaybackControllerWithAdContextPolicy:nil viewStrategy:nil] ; playController.delegate = self;</p>

<p>  if (self.resumePlayback) { // définit le temps de fondu de l'obturateur sur zéro pour masquer immédiatement la vue du lecteur. playController.shutterFadeTime = 0.0; playController.shutter = OUI;</p>

<pre><code>// désactive la lecture automatique lors de la reprise de la lecture. playbackController.autoPlay = NON ; </code></pre>

<p>  } ```</p>

<p>Notez que lorsque Seek Without Ads est utilisé dans votre application, vous pouvez observer un trafic réseau qui se produit normalement dans le cadre de la configuration du plug-in IMA. Ce trafic est nécessaire pour une configuration correcte du plug-in et n'affecte pas la fonctionnalité de recherche sans publicité.</p>

<h1>Personnalisation du comportement du plugin</h1>

<p>Il y a quelques points de configuration dans BCOVIMA. Vous pouvez combiner BCOVIMA avec un autre plug-in pour le Brightcove Player SDK pour iOS, vous pouvez créer une stratégie d'affichage personnalisée et vous pouvez fournir une politique de demande d'annonces personnalisée.</p>

<h2>Règles relatives aux annonces VAST et VMAP</h2>

<p>BCOVIMA vous permet de contrôler la manière dont les demandes d'annonces sont effectuées, via le <a href="Classes/BCOVIMAAdsRequestPolicy.html"><code>BCOVIMAAdsRequestPolitique</code></a> classer. La classe fournit des méthodes de fabrique pour les stratégies prises en charge. Une fois que vous avez obtenu une instance de la bonne stratégie, vous devez la fournir au <code>BCOVPlayerSDKManager</code> pour créer un contrôleur de lecture ou un fournisseur de session de lecture.</p>

<p>Dans Quick Start, un exemple de VMAP est donné. Voici un exemple VAST.</p>

<pre><code> IMASettings *imaSettings = [[IMASettings alloc] init]; imaSettings.ppid = kViewControllerIMAPublisherID; imaSettings.language = kViewControllerIMALanguage; IMAAdsRenderingSettings *renderSettings = [[IMAAdsRenderingSettings alloc] init]; renderSettings.webOpenerPresentingController = self; UIView *videoContainerView = &lt;UIView du conteneur vidéo&gt; ; [1] BCOVIMAAdsRequestPolicy *adsRequestPolicy = [BCOVIMAAdsRequestPolicy adsRequestPolicyWithVASTAdTagsInCuePointsAndAdsCuePointProgressPolicy:nil] ; BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManagersharedManager] ; id&lt;BCOVPlaybackController&gt; controller = [manager createIMAPlaybackControllerWithSettings:imaSettings adsRenderingSettings:renderSettings adsRequestPolicy:adsRequestPolicy adContainer:videoContainerView viewController:self compagnonSlots:nil viewStrategy:nil] ; </code></pre>

<p>Laisser&rsquo;s décomposez ce code en étapes, pour le rendre un peu plus simple à digérer :</p>

<ol>
<li>Cet exemple est le même que celui fourni dans le démarrage rapide, sauf que nous appelons maintenant un autre <code>BCOVIMAAdsRequestPolitique</code> méthode de politique pour spécifier que nous voulons utiliser VAST.</li>
</ol>


<p><a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolitique</a> dispose de quatre méthodes d'usine pour générer une politique de demande d'annonces ; deux pour VMAP et deux pour VAST. Deux méthodes d'usine pour VMAP sont décrites plus en détail ci-dessous :</p>

<ul>
<li><p><code>+videoPropertiesVMAPAdTagUrlAdsRequestPolicy</code>: Cette méthode renvoie la règle de demande d'annonces par défaut, qui recherche le <code>kBCOVIMAAdTag</code> dans chaque BCOVVidéo&rsquo;s propriétés pour déterminer le tag d'emplacement publicitaire VMAP qui doit être utilisé pour demander des annonces.</p></li>
<li><p><code>+adsRequestPolicyWithVMAPAdTagUrl :</code>: Cette méthode renvoie une règle de demande d'annonces qui utilise toujours le même tag d'emplacement publicitaire pour chaque vidéo. Si vous utilisez cette politique, vous n'avez pas besoin de mettre le tag publicitaire dans les BCOVVideos' Propriétés. C'est le moyen le plus simple de spécifier un tag d'emplacement publicitaire si vous savez que votre tag d'emplacement publicitaire ne changera jamais pendant la durée de vie de la session d'application.</p></li>
</ul>


<p>Il existe deux méthodes d'usine pour VAST. Toutes les méthodes VAST prennent une BCOVCuePointProgressPolicy. La politique de point de repère détermine quels BCOVCuePoints seront traités par le <a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolitique</a>. Les règles VAST sont les suivantes :</p>

<ul>
<li><p><code>+adsRequestPolicyWithVASTAdTagsInCuePointsAndAdsCuePointProgressPolicy :</code> Cette méthode renvoie une stratégie de demande d'annonces qui vérifie chaque BCOVVideo pour les BCOVCuePoints de type &lsquo;kBCOVIMACuePointTypeAd&rsquo; et regarde dans chacune de ces propriétés de points de repère pour la clé <code>kBCOVIMAAdTag</code> pour déterminer le tag d'emplacement publicitaire VAST à utiliser pour demander des annonces.</p></li>
<li><p><code>+adsRequestPolicyFromCuePointPropertiesWithAdTag:adsCuePointProgressPolicy :</code> Cette méthode renvoie une règle de demande d'annonce qui utilise le tag d'emplacement publicitaire VAST spécifié pour tous les BCOVCuePoints de type <strong>kBCOVIMACuePointTypeAd</strong>. Les propriétés du point de repère sont ajoutées au tag d'emplacement publicitaire en tant que paramètres de requête.</p></li>
</ul>


<p>Vous pouvez ajouter des points de repère de tag d'emplacement publicitaire VAST à une vidéo en utilisant le <code>mettre à jour:</code> méthode sur le <code>BCOVVidéo</code> objet. L'exemple suivant ajoute des points de repère pré-roll, mid-roll et post-roll :</p>

<pre><code>// Objective-C - (BCOVVideo *)updateVideo:(BCOVVideo *)video { // Determine mid-point of video so we can insert a cue point there CGFloat durationMiliSeconds = ((NSNumber *)video.properties[@"duration"]).doubleValue; CGFloat midpointSeconds = (durationMiliSeconds / 2) / 1000; CMTime midpointTime = CMTimeMakeWithSeconds(midpointSeconds, 1); return [video update:^(id&lt;BCOVMutableVideo&gt; mutableVideo) { mutableVideo.cuePoints = [[BCOVCuePointCollection alloc] initWithArray:@[ [[BCOVCuePoint alloc] initWithType:kBCOVIMACuePointTypeAd position:kCMTimeZero properties:@{ kBCOVIMAAdTag : kVASTAdTagURL }], [[BCOVCuePoint alloc] initWithType:kBCOVIMACuePointTypeAd position:midpointTime properties:@{ kBCOVIMAAdTag : kVASTAdTagURL }], [[BCOVCuePoint alloc] initWithType:kBCOVIMACuePointTypeAd position:kBCOVCuePointPositionTypeAfter properties:@{ kBCOVIMAAdTag : kVASTAdTagURL } ] ]] ; }] ; } </code></pre>

<pre><code>// Swift func updateVideo(withVASTTag vastTag : Chaîne) -&gt; BCOVVidéo ? { guard let durationNum = self.properties["duration"] as? NSNumber else { return nil } let durationMiliSeconds = durationNum.doubleValue let midpointSeconds = (durationMiliSeconds / 2) / 1000 let midpointTime = CMTimeMakeWithSeconds(midpointSeconds, favoriteTimescale: 1) let cuePointPositionTypeAfter = CMTime.positiveInfinity renvoie la mise à jour { (mutableVideo: BCOVMutableVideo?) in guard let mutableVideo = mutableVideo else { return } mutableVideo.cuePoints = BCOVCuePointCollection(tableau : [ BCOVCuePoint(type : kBCOVIMACuePointTypeAd, position : CMTime.zero, propriétés : [kBCOVIMAAdTag:vastTag]) !, BCOVCuePoint(type : kBCOVIMACuePointTypeAd, position : midpointTime, propriétés : [kBCOVIMAAdTag:vastTag]) !, BCOVCuePoint(type : kBCOVIMACuePointTypeIMAd, position : cuePoint:BCAAdTagt properties ])!, ]) } } </code></pre>

<p>Vous pouvez également convertir les points de repère créés dans VideoCloud en points de repère VAST comme ceci :</p>

<pre><code>- (BCOVVideo *)updateVideo:(BCOVVideo *)video NSArray *cuePoints = video.cuePoints.array; NSMutableArray *updatedCuePoints = @[].mutableCopy; pour (BCOVCuePoint *cuePoint en cuePoints) { if ([cuePoint.type isEqualToString:kBCOVIMACuePointTypeAd]) { // The "metadata" property is the value of the // "Key/Value Pairs" field in VideoCloud when // creating/editing a Cue Point. In this example // the only value in this field is the VAST ad tag URL. // If you have additional values you'll need to parse // out just the ad tag URL. NSString *metadata = cuePoint.properties[@"metadata"]; NSDictionary *properties = @{ kBCOVIMAAdTag : metadata } ; BCOVCuePoint *updatedCuePoint = [[BCOVCuePoint alloc] initWithType:cuePoint.type position:cuePoint.position properties:properties]; [updatedCuePoints addObject:updatedCuePoint] ; } } return [video update:^(id&lt;BCOVMutableVideo&gt; mutableVideo) { mutableVideo.cuePoints = [BCOVCuePointCollection collectionWithArray:updatedCuePoints]; } ; } </code></pre>

<h2>Modification de l'IMAAdsRequest</h2>

<p>Le plugin IMA passe un <code>Demande d'annonces IMA</code> s'opposer à un <code>BCOMIMALectureSessionDélégué</code> juste avant d'appeler <code>IMAAdsLoader -requestAdsWithAdsRequest</code> , permettant à l'utilisateur de modifier d'abord la demande d'annonces. Pour recevoir le rappel de la demande d'annonces, créez un objet qui implémente le <a href="Protocols/BCOVIMAPlaybackSessionDelegate.html"><code>BCOVIMALectureSessionDélégué</code></a> protocole.</p>

<pre><code>@import BrightcovePlayerSDK ; @import BrightcoveIMA; @interface MyViewController : UIViewController BCOVIMAPlaybackSessionDélégué </code></pre>

<p>Créer un <code>Fournisseur de session BCOVIMA</code> en utilisant soit <code>createIMAPlaybackControllerWithSettings</code> ou <code>createIMASessionProviderWithSettings</code> , et fournir un NSDictionary d'options avec une entrée ayant une clé de <code>kBCOVIMAOptionIMAPlaybackSessionDelegateKey</code> et une valeur qui est votre délégué.</p>

<pre><code>NSDictionary *imaSessionProviderOptions = @{ kBCOVIMAOptionIMAPlaybackSessionDelegateKey: self } ; id&lt;BCOVPlaybackSessionProvider&gt; imaSessionProvider = [sdkManager createIMASessionProviderWithSettings:imaSettings adsRenderingSettings:renderSettings adsRequestPolicy:adsRequestPolicy adContainer:self.playerView.contentOverlayView viewController:self compagnonessions:Slotsima en amont] </code></pre>

<p>Mettre en place <code>willCallIMAAdsLoaderRequestAdsWithRequest:forPosition :</code> dans ton <code>BCOVIMALectureSessionDélégué</code>.</p>

<pre><code>- (void)willCallIMAAdsLoaderRequestAdsWithRequest:(IMAAdsRequest *)adsRequest forPosition:(NSTimeInterval)position { adsRequest.vastLoadTimeout = 3000.; } </code></pre>

<h2>Voir la stratégie</h2>

<p>Vous pouvez fournir une stratégie d'affichage personnalisée au BCOVPlaybackManager lorsque vous construisez votre contrôleur de lecture ou votre fournisseur de session, plutôt que de spécifier directement la stratégie defaultControlsViewStrategy. Avec une stratégie d'affichage personnalisée, l'affichage du conteneur d'annonces et les emplacements associés aux annonces peuvent être liés à l'affichage du contenu vidéo. Ceci est un exemple de stratégie de vue personnalisée.</p>

<pre><code>BCOVPlaybackControllerViewStrategy customViewStrategy = ^UIView* (UIView *view, id&lt;BCOVPlaybackController&gt; playController){ BCOVPlaybackControllerViewStrategy defaultControlsViewStrategy = [playbackManager defaultControlsViewStrategy]; UIView *contentAndDefaultControlsView = defaultControlsViewStrategy(view, playbackController); [&lt;UIView of video container&gt; addSubview:contentAndDefaultControlsView]; return &lt;UIView of video container&gt;; } ; </code></pre>

<h2>Fournisseurs de sessions de composition</h2>

<p>Si vous utilisez plus d'un plug-in pour le Brightcove Player SDK pour iOS qui doit créer un contrôleur de lecture personnalisé, vous devez à la place composer une chaîne de fournisseurs de session et transmettre le fournisseur de session final au <code>[BCOVPlayerSDKManager createPlaybackControllerWithSessionProvider:viewStrategy:]</code> méthode.</p>

<p>Lors de la composition des fournisseurs de session, le préchargement de session peut être activé à partir de <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVBasicSessionProvider.h#L31-L46"><code>BCOVBasicSessionProvider</code></a> ; cependant, le préchargement des sessions avec le plugin IMA est <strong>fortement déconseillé</strong> en raison d'un bogue dans le SDK IMA de Google lors de la mémoire de plusieurs AVPlayers.</p>

<h1>Enregistrement des superpositions d'annonces</h1>

<p>Si vous placez des vues sur des publicités pendant leur lecture, il est nécessaire d'enregistrer ces vues avec le SDK IMA. Lis le <strong>Obstacles amicaux</strong> partie de la <a href="https://developers.google.com/interactive-media-ads/docs/sdks/ios/omsdk">Mesure ouverte dans le SDK IMA </a> page pour plus d'informations.</p>

<p>Vous pouvez obtenir l'objet IMAAdDisplayContainer actuel nécessaire pour enregistrer vos superpositions à partir du <code>playbackController:playbackSession:didEnterAdSequence :</code> méthode de délégation de votre instance BCOVPlaybackController. Par exemple: <code> - (void)playbackController:(id&lt;BCOVPlaybackController&gt;)contrôleur playbackSession:(id&lt;BCOVPlaybackSession&gt;)session didEnterAdSequence:(BCOVAdSequence *)adSequence { NSDictionary *props = session.video.properties; IMAAdDisplayContainer *adDisplayContainer = props[kBCOVIMAVideoPropertiesKeyAdDisplayContainer]; [adDisplayContainer registerFriendlyObstruction:self.adOverlayView]; } </code></p>

<p>Pour annuler l'enregistrement des obstructions lorsque la séquence publicitaire est terminée, le <code>playbackController:playbackSession:didExitAdSequence :</code> La méthode déléguée de votre instance BCOVPlaybackController peut être utilisée. Par exemple: <code> - (void)playbackController:(id&lt;BCOVPlaybackController&gt;)contrôleur playbackSession:(id&lt;BCOVPlaybackSession&gt;)session didExitAdSequence:(BCOVAdSequence *)adSequence { NSDictionary *props = session.video.properties; IMAAdDisplayContainer *adDisplayContainer = props[kBCOVIMAVideoPropertiesKeyAdDisplayContainer]; [adDisplayContainer unregisterAllFriendlyObstructions]; } </code></p>

AirPlay<h1></h1>

<p>Le plugin IMA prend en charge AirPlay pour les publicités pré-roll et post-roll. Régler <code>activerBackgroundPlayback</code> à <code>OUI</code> au <code>Paramètres IMA</code> avec l'activation d'AirPlay sur votre <code>Contrôleur de lecture BCOV</code>. Voir le &ldquo;<em>AirPlay</em>&rdquo; partie de la <a href="https://github.com/brightcove/brightcove-player-sdk-ios#airplay-">LISEZ-MOI du SDK principal</a> pour plus d'informations.</p>

<h1>Ciblage par segments d'audience</h1>

<p>Si tu&rsquo;Si vous souhaitez utiliser le ciblage par segments d'audience avec vos demandes d'annonces IMA VAST, vous pouvez le faire en utilisant le <code>updateAudienceSegmentTargetingValues</code> au <code>Contrôleur de lecture BCOV</code>. Par exemple :</p>

<pre><code>[playbackController updateAudienceSegmentTargetingValues :@{ @"account_id":@"11223344", @"account_type":@"premium"" } ; </code></pre>

<p>Ces valeurs seront ajoutées au <code>cus_params</code> paramètre de requête de l'URL de demande d'annonce IMA. Par exemple:</p>

<p>L'URL <a href="http://pubads.g.doubleclick.net/gampad/ads"><code>http://pubads.g.doubleclick.net/gampad/ads</code></a> deviendrait <a href="http://pubads.g.doubleclick.net/gampad/ads?cust_params=account_id%3D11223344%26account_type%3Dpremium"><code>http://pubads.g.doubleclick.net/gampad/ads?cust_params=account_id%3D11223344%26account_type%3Dpremium</code></a>.</p>

<h1>Ciblage publicitaire par appareil</h1>

<p>Vous pouvez utiliser le <code>kBCOVIMAOptionBlockAdTargetingAPIsKey</code> lors de la configuration de votre <code>IMASessionProvider</code> ou IMA <code>Contrôleur de lecture BCOV</code> pour empêcher les appels à <a href="https://developer.apple.com/documentation/adsupport">AdSupport</a> et <a href="https://developer.apple.com/documentation/apptrackingtransparency">AppTrackingTransparence</a> API qui ne peuvent pas être utilisées dans certains scénarios de soumission App Store.</p>

<pre><code>// BCOVPlaybackController NSDictionary *imaPlaybackSessionOptions = @{ kBCOVIMAOptionIMAPlaybackSessionDelegateKey: self, kBCOVIMAOptionBlockAdTargetingAPIsKey: @(YES) } ; self.playbackController = [manager createIMAPlaybackControllerWithSettings:imaSettings adsRenderingSettings:renderSettings adsRequestPolicy:adsRequestPolicy adContainer:self.playerView.contentOverlayView viewController:self compagnonSlots:nil viewStrategy:nil options:imaPlaybackSessionOptions]; </code></pre>

<pre><code>// IMASessionProvider NSDictionary *imaPlaybackSessionOptions = @{ kBCOVIMAOptionIMAPlaybackSessionDelegateKey: self, kBCOVIMAOptionBlockAdTargetingAPIsKey: @(YES) } ; id&lt;BCOVPlaybackSessionProvider&gt; imaSessionProvider = [manager createIMASessionProviderWithSettings:imaSettings adsRenderingSettings:renderSettings adsRequestPolicy:adsRequestPolicy adContainer:self.playerView.contentOverlayView viewController:Option compagnonSlotes;nil </code></pre>

<h1>Questions fréquemment posées</h1>

<p><em>Je peux entendre les publicités, mais je peux&rsquo;ne les vois pas jouer.</em></p>

<p>Cela se produit généralement lorsque la vue du conteneur publicitaire n'est pas dans la hiérarchie des vues, ou lorsque la vue publicitaire (qui est une sous-vue de la vue du conteneur publicitaire) est couverte par d'autres vues.</p>

<h1>Soutien</h1>

<p>Si vous avez des questions, avez besoin d'aide ou souhaitez faire part de vos commentaires, veuillez utiliser le <a href="https://supportportal.brightcove.com/s/login/">Portail d'assistance</a> ou contactez votre gestionnaire de compte. Pour recevoir une notification des nouvelles versions du logiciel SDK, abonnez-vous aux SDK Brightcove Native Player <a href="https://groups.google.com/g/brightcove-native-player-sdks">Groupe Google</a>.</p>
						
						
					</div>
					

					<div class="index-container">
						

						
						<div class="index-column">
							<h2 class="index-title">Références de classe</h2>
							<ul>
								
								<li><a href="Classes/BCOVIMAAdsRequestPolicy.html">BCOVIMAAdsRequestPolitique</a></li>
								
								<li><a href="Classes/BCOVIMAComponent.html">Composant BCOVIMA</a></li>
								
							</ul>
						</div>
						

						
						<div class="index-column">
							
							<h2 class="index-title">Références de protocole</h2>
							<ul>
								
								<li><a href="Protocols/BCOVIMAPlaybackSessionDelegate.html">BCOVIMALectureSessionDélégué</a></li>
								
							</ul>
							

							

							
							<h2 class="index-title">Références de catégorie</h2>
							<ul>
								
								<li><a href="Categories/BCOVPlayerSDKManager-BCOVIMAAdditions.html">BCOVPlayerSDKManager(BCOVIMAajouts)</a></li>
								
								<li><a href="Categories/BCOVSessionProviderExtension-BCOVIMAAdditions.html">Extension du fournisseur de session BCOV(Ajouts BCOVIMA)</a></li>
								
							</ul>
							
						</div>
						
					</div>

					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">droits d'auteur &copy; 2021 Brightcove. Tous les droits sont réservés. Mis à jour: 2021-07-08</p>
							
							
							<p class="generator">Généré par <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="js/script.js"></script>
</body>
</html>
