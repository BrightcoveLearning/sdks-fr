---
title: Picture in Picture avec la description des SDK natifs : Dans cette rubrique, vous apprendrez à implémenter le mode Image dans l'image dans vos applications à l'aide des SDK Brightcove Native Player.
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">Aperçu</h2>

<p>Le mode Image dans l'image (PIP) permet aux utilisateurs d'effectuer plusieurs tâches sur leurs appareils. Avec cette fonctionnalité, vous pouvez créer des applications dans lesquelles une petite fenêtre de lecture vidéo est épinglée dans un coin de l'écran pendant que l'utilisateur effectue d'autres tâches.</p>

<figure class="bcls-figure"><img class="bcls-image--no-border" width="600" alt="Picture in picture mode" src="/assets/images/getting-started/pip/android-steps.png" />
<figcaption class="bcls-caption--image">Image en mode image</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="Features">Caractéristiques</h2>

<p>La fonctionnalité d'image dans l'image fournie par les kits SDK natifs Brightcove prend en charge les fonctionnalités suivantes :</p>

<ul>
	<li>Lorsqu'un utilisateur entre en mode image en image en cliquant sur l'icône PIP dans la barre de contrôle, un développeur peut entrer en mode PIP par programmation.</li>
	<li>L'utilisateur peut faire glisser la fenêtre PIP dans les coins de l'écran pour la placer à l'endroit le plus pratique.</li>
	<li>L'utilisateur peut mettre en pause et lire la vidéo dans la fenêtre PIP, ou la supprimer complètement. L'utilisateur peut également maximiser la vidéo vers l'expérience in-app.</li>
	<li>Le mode PIP fonctionne au-dessus de l'application, de l'arrière-plan de l'appareil et d'autres applications.</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Supported_versions">Versions prises en charge</h2>

<p>Le mode Image dans l'image est pris en charge avec les versions suivantes :</p>

<h3>Version du système d'exploitation de l'appareil</h3>

<ul>
	<li>Android:<strong></strong> Oreo 8.0+ (API niveau 26+)</li>
	<li><strong>iOS :</strong> 10.0+</li>
</ul>

<h3>Version native du SDK</h3>

<ul>
	<li>Android:<strong></strong> Kit de développement logiciel (SDK) natif Brightcove pour Android version 6.1.0+</li>
	<li><strong>iOS :</strong> Kit de développement logiciel (SDK) natif Brightcove pour iOS version 6.4.4+</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Android_implementation">Implémentation Android</h2>

<p>Les rubriques suivantes vous aideront à démarrer avec la fonctionnalité d'image dans l'image :</p>

<ul>
	<li><a href="#Using_BrightcovePlayer">Utilisation de BrightcovePlayer</a></li>
	<li><a href="#Using_a_regular_Activity">Utiliser une activité régulière</a></li>
	<li><a href="#Customizing_picture_in_picture">Personnaliser l'image dans l'image</a></li>
</ul>

<p>Pour plus de détails, voir Android <a href="https://developer.android.com/guide/topics/ui/picture-in-picture.html">Guide d'assistance image dans l'image</a>.</p>

<h3 id="Using_BrightcovePlayer">Utilisation de BrightcovePlayer</h3>

<p>La façon la plus simple de commencer à utiliser l'image dans l'image est de faire en sorte que votre activité étende la <code translate="No">BrightcovePlayer</code>. Pour le faire, suivez ces étapes:</p>

<ol class="bcls-tasklist">
	<li>Dans ton <strong>styles.xml</strong> fichier, activez le bouton image dans l'image en ajoutant le code suivant :

	<pre class="line-numbers">
<code class="language-xml" translate="No">&lt;style name="BrightcoveControlBar" parent="BrightcoveControlBarDefault"&gt;
    &lt;item name="brightcove_picture_in_picture"&gt;true&lt;/item&gt;
&lt;/style&gt;</code></pre>
	</li>
	<li>Dans ton <strong>AndroidManifest.xml</strong> déposer, <a href="https://developer.android.com/guide/topics/ui/picture-in-picture.html#declaring">déclarer le support d'image dans l'image</a> pour l'activité en ajoutant ce qui suit :
	<pre class="line-numbers">
<code class="language-xml" translate="No">&lt;activity android:name="VideoActivity"
  android:resizeableActivity="true"
<span class="bcls-highlight">  android:supportsPictureInPicture="true"
  android:configChanges=
      "screenSize|smallestScreenSize|screenLayout|orientation"</span>
  ...
</code></pre>

	<p>Ceci est une étape importante. Si vous ne le déclarez pas, lorsqu'un utilisateur appuie sur le bouton Image dans l'image dans le Brightcove Media Controller, un <code translate="No">IllegalStateException</code> sera jeté :</p>

	<pre>
<code class="language-java" translate="No">java.lang.IllegalStateException: enterPictureInPictureMode: Current activity does not support picture in picture</code></pre>
	</li>
</ol>

<p>Lorsque vous passez en mode image en image, l'activité elle-même est redimensionnée, conservant tous les composants de l'activité dans la fenêtre image en image. Pour éviter cela et pour faciliter la mise en œuvre, la vue vidéo Brightcove passera automatiquement en plein écran pour correspondre à la largeur et à la hauteur de la disposition parente affichant uniquement la vidéo dans la fenêtre image dans l'image. Une fois que vous quittez ce mode, la vue vidéo Brightcove revient à son état d'origine.</p>

<p>Si vous ne voulez pas d'image dans l'image dans votre application, vous pouvez désactiver le bouton Image dans l'image en ajoutant le code suivant dans votre <strong>styles.xml</strong> déposer:</p>

<pre class="line-numbers">
<code class="language-xml" translate="No">&lt;style name="BrightcoveControlBar" parent="BrightcoveControlBarDefault"&gt;
    &lt;item name="brightcove_picture_in_picture"&gt;false&lt;/item&gt;
&lt;/style&gt;</code></pre>

<h3 id="Using_a_regular_Activity">Utiliser une activité régulière</h3>

<p>Si vous utilisez une activité qui ne s'étend pas <code translate="No">BrightcovePlayer</code> , en plus de déclarer la prise en charge de l'image dans l'image comme mentionné dans la section précédente, vous devez suivre quelques étapes supplémentaires :</p>

<ol class="bcls-tasklist__restart">
	<li>Ouvrez le <strong>MainActivity.java</strong> déposer.</li>
	<li>Dans le <code translate="No">onCreate</code> méthode de l'activité, enregistrez l'activité auprès du Brightcove <code translate="No">PictureInPictureManager</code>:
	<pre>
<code class="language-java" translate="No">PictureInPictureManager.getInstance().registerActivity(Activity, BrightcoveVideoView)</code></pre>
	</li>
	<li>Dans le <code translate="No">onDestroy</code> méthode, désinscrire l'activité :
	<pre>
<code class="language-java" translate="No">PictureInPictureManager.getInstance().unregisterActivity(Activity)</code></pre>
	</li>
	<li>Remplacer le <code translate="No">onPictureInPictureModeChanged</code> Méthode d'activité et appel <code translate="No">onPictureInPictureModeChanged()</code> méthode comme indiqué ci-dessous :
	<pre class="line-numbers">
<code class="language-java" translate="No">@Override
  public void onPictureInPictureModeChanged (boolean isInPictureInPictureMode, Configuration newConfig) {
     super.onPictureInPictureModeChanged(isInPictureInPictureMode, newConfig);
     PictureInPictureManager.getInstance().onPictureInPictureModeChanged(isInPictureInPictureMode, newConfig);
  }</code></pre>
	</li>
	<li>Enfin, remplacez le <code translate="No">onUserLeaveHint()</code> Méthode d'activité et appel <code translate="No">onUserLeaveHint()</code> comme indiqué ci-dessous:
	<pre class="line-numbers">
<code class="language-java" translate="No">@Override
  public void onUserLeaveHint () {
     super.onUserLeaveHint();
     PictureInPictureManager.getInstance().onUserLeaveHint();
  }</code></pre>
	</li>
</ol>

<p>Après avoir suivi ces étapes, le bouton Image dans l'image apparaîtra automatiquement dans le Brightcove Media Controller. Vous pouvez également déclencher l'image dans l'image par programmation comme suit :</p>

<pre>
<code class="language-java" translate="No">PictureInPictureManager.getInstance().enterPictureInPictureMode()</code></pre>

<aside class="bcls-aside bcls-aside--information">Notez que l'appel de cette méthode lancera un <code translate="No">PictureInPictureManagerException</code> si une Activité n'a pas été enregistrée.</aside>

<h3 id="Customizing_picture_in_picture">Personnaliser l'image dans l'image</h3>

<p>Vous pouvez personnaliser le comportement et l'apparence de l'image dans la fenêtre d'image via le <code translate="No">PictureInPictureManager</code>. Par exemple, vous pouvez modifier le rapport hauteur/largeur de la fenêtre ou activer/désactiver les sous-titres pour vos vidéos.</p>

<p>Android Oreo propose nativement trois paramètres personnalisables :</p>

<ul>
	<li><a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder.html#setAspectRatio(android.util.Rational)">ratio d'aspect</a>

	<pre>
<code class="language-java" translate="No">setAspectRatio(Rational)</code></pre>
	</li>
	<li><a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder.html#setSourceRectHint(android.graphics.Rect)">indice des limites de la source</a>
	<pre>
<code class="language-java" translate="No">setSourceRectHint(Rect)</code></pre>
	</li>
	<li><a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder.html#setActions(java.util.List%3Candroid.app.RemoteAction%3E)">liste des actions à distance</a>
	<pre>
<code class="language-java" translate="No">setUserActions(List&lt;RemoteAction&gt;)</code></pre>
	</li>
</ul>

<h4>Actions de l'utilisateur</h4>

<p>Brightcove ajoute un <code translate="No">RemoteAction</code> par défaut, qui gère le <code translate="No">Play/Pause</code> événements vidéo et définit leurs icônes respectives. Cela signifie que la valeur par défaut <code translate="No">RemoteAction</code> sera ajouté à la liste des actions à distance que vous définissez avec les éléments suivants :</p>

<pre>
<code class="language-java" translate="No">setUserActions</code></pre>

<p>Gardez à l'esprit que vous ne pouvez définir qu'un nombre limité d'actions. Pour obtenir le <a href="https://developer.android.com/reference/android/app/Activity.html#getMaxNumPictureInPictureActions()">nombre maximum d'actions</a> , appelez le suivant :</p>

<pre>
<code class="language-java" translate="No">Activity.getMaxNumPictureInPictureActions()</code></pre>

<h4>Sous-titres codés</h4>

<p>Vous pouvez activer/désactiver les sous-titres lors de la lecture d'une vidéo en mode Image dans l'image en appelant ce qui suit dans le <code translate="No">inPictureInPictureManager</code>.</p>

<pre>
<code class="language-java" translate="No">setClosedCaptionsEnabled(boolean)</code></pre>

<p>Les sous-titres sont désactivés par défaut sur les téléphones mais activés sur les tablettes. Pour réduire la taille des sous-titres lors de la lecture en mode Image dans l'image, appelez ce qui suit pour définir une valeur entre <code translate="No">0</code> et <code translate="No">1.0f</code>.</p>

<pre>
<code class="language-java" translate="No">setClosedCaptionsReductionScaleFactor(float)</code></pre>

<p>Par défaut, la taille des sous-titres en mode image en image est <code translate="No">0.5f</code> ou 50 % de la taille d'origine. Enfin, pour entrer image en mode image lorsque l'Activité <code translate="No">onUserLeaveHint()</code> est appelé, définissez ce qui suit sur <code translate="No">true</code>:</p>

<pre>
<code class="language-java" translate="No">setOnUserLeaveEnable(boolean)</code></pre>

<h4>Paramètres</h4>

<p>Pour récupérer l'image actuelle dans les paramètres d'image, vous pouvez appeler ce qui suit :</p>

<pre>
<code class="language-java" translate="No">PictureInPicture.getBrightcovePictureInPictureParams()</code></pre>

<p>Cet appel renvoie le <code translate="No">BrightcovePictureInPictureParams</code> objet, qui a les getters pour tous les paramètres discutés précédemment.</p>
</section>

<section class="bcls-section">
<h2 id="iOS_implementation">Implémentation iOS</h2>

<p>Pour commencer avec l'image dans l'image, ajoutez <code translate="No">showPictureInPictureButton</code> à <code translate="No">BCOVPUIPlayerViewOptions</code>. Lorsqu'il est défini sur true, un bouton image dans l'image sera ajouté aux commandes du lecteur sur les appareils pris en charge.</p>
<p>L'image dans l'image est l'un des <a href="https://www.apple.com/ios/ios-14/features/">nouvelles fonctionnalités avec iOS 14</a>.</p>

<p>Pour plus de détails, voir ce qui suit :</p>

<ul>
	<li>Les <a href="https://github.com/brightcove/brightcove-player-sdk-ios#PIP">Image dans l'image</a> section de référence du Brightcove Native SDK pour iOS</li>
	<li>Pommes <a href="https://developer.apple.com/documentation/avkit/adopting_picture_in_picture_in_a_custom_player">Adopter l'image dans l'image dans un lecteur personnalisé</a> document</li>
</ul>

<p>Pour un exemple de code, voir le <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoCloudBasicPlayer">Application de lecture vidéo de base</a>.</p>
</section>

<section class="bcls-section">
<h2 id="Limitations">Limites</h2>

<h3>Android</h3>

<ul>
	<li>L'image dans l'image ne fonctionnera que sur les appareils avec Android Oreo ou supérieur</li>
	<li>Il n'est actuellement pas pris en charge pour Android TV</li>
	<li>Les vidéos avec des publicités ne sont pas prises en charge</li>
	<li>Les vidéos 360 ne sont pas prises en charge</li>
</ul>

<h3>iOS</h3>

<ul>
	<li>Les vidéos avec des publicités ne sont pas prises en charge</li>
	<li>Les vidéos 360 ne sont pas prises en charge</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Known_issues">Problèmes connus</h2>

<h3>Android</h3>

<ul>
	<li>Nous avons constaté que les vidéos protégées par Widevine lues en mode image en image deviendront transparentes ou noires dans le Pixel C avec Android 8.0. Le problème n'est pas reproductible dans le même appareil avec Android 8.1.</li>
</ul>
</section>
</article>