---
title: 'Synchronisation des sous-titres WebVTT' la
description: Dans cette rubrique, vous apprendrez à configurer les sous-titres WebVTT pour les vidéos HLS afin de synchroniser l'audio et la vidéo avec les sous-titres.
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">Aperçu</h2>

<p>Le fichier Web Video Text Tracks (WebVTT) est un simple fichier texte utilisé pour associer des légendes, des sous-titres, des descriptions, etc. avec des segments de temps dans votre vidéo.</p>

<pre class="line-numbers">
<code class="language-html" translate="No">WEBVTT

  00:00:03.50 --&gt; 00:00:05.000 align:middle line:84%
  In this video, you'll learn
  about how Video Cloud Studio is</code></pre>

<p>Pour plus de détails sur l'ajout d'un fichier WebVTT, consultez le <a href="https://player.support.brightcove.com/general/adding-captions-videos-programmatically.html">Ajouter des légendes aux vidéos</a> document.</p>

<!-- <p>The <a href="https://github.com/brightcove/brightcove-player-sdk-ios-sidecarsubtitles">Sidecar Subtitles plugin</a> enables you to use WebVTT captions in your iOS and tvOS apps.</p> -->
</section>

<section class="bcls-section">
<h2 id="Add_a_metadata_header">Ajouter un en-tête de métadonnées</h2>

<p>Dans le cadre de la spécification HLS, vous devez ajouter un <code translate="No">X-TIMESTAMP-MAP</code> en-tête de métadonnées à chaque en-tête WebVTT afin de synchroniser les horodatages entre l'audio et la vidéo avec vos sous-titres.</p>

<p>S'il vous manque cet en-tête ou le <code translate="No">MPEGTS</code> valeur n'est pas correcte, vous pouvez constater que vos sous-titres ne sont pas synchronisés avec la vidéo. C'est parce que lorsque le <code translate="No">X-TIMESTAMP-MAP</code> l'en-tête est manquant, le client suppose un décalage d'horodatage par défaut de <strong>0</strong>. Par exemple, la différence entre l'utilisation d'une valeur de <strong>900000</strong> et <strong>0</strong> peut entraîner la suppression de vos sous-titres de 10 secondes.</p>

<p><code translate="No">X-TIMESTAMP-MAP</code> format:</p>

<pre class="line-numbers">
<code class="language-swift" translate="No">X-TIMESTAMP-MAP=MPEGTS:&lt;MPEG-2 time&gt;,LOCAL:&lt;cue time&gt;</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="2" data-gist-hide-footer="true"></code></p> -->

<p>Voici un exemple de fichier WebVTT :</p>

<aside class="bcls-aside bcls-aside--information">Les <code translate="No">X-TIMESTAMP-MAP</code> l'en-tête doit apparaître à la ligne 2, juste après le <code translate="No">WEBVTT</code> ligne. Vous pouvez rencontrer des résultats inattendus si l'en-tête d'horodatage n'est pas placé sur la ligne 2.</aside>

<pre class="line-numbers">
<code class="language-swift" translate="No">WEBVTT
<span class="bcls-highlight">X-TIMESTAMP-MAP=MPEGTS:900000,LOCAL:00:00:00.000</span>

1
00:00:03.500 --&gt; 00:00:05.000 align:middle line:84%
In this video, you'll learn
about how Video Cloud Studio is</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="5-11" data-gist-highlight-line="6" data-gist-hide-footer="true"></code></p> -->

<p>Pour plus de détails, consultez le <a href="https://tools.ietf.org/html/draft-pantos-http-live-streaming-18#section-3">Segments de sous-titres</a> section du document du protocole HLS d'Apple.</p>
</section>

<section class="bcls-section">
<h2 id="Determine_the_offset_value">Déterminer la valeur de décalage</h2>

<p>Si vous utilisez Dynamic Ingest ou Zencoder de Brightcove pour transcoder votre contenu, utilisez une valeur de décalage de <code translate="No">MPEGTS:900000</code>.</p>

<p>Si vous utilisez un système d'encodage autre que Zencoder, il est préférable d'obtenir la valeur nécessaire. Apple vous recommande de définir le décalage pour qu'il corresponde à votre vidéo encodée.</p>

<p>Les <code translate="No">MPEGTS</code> correspond à la valeur d'horodatage de présentation (PTS) de la trame MPEG à l'heure donnée. <code translate="No">LOCAL</code> temps. Si vous utilisez le système d'acquisition hérité de Brightcove, vous constaterez peut-être que vous pouvez utiliser une valeur de <code translate="No">MPEGTS:0</code>.</p>

<p>Si votre compte est activé pour <a href="https://studio.support.brightcove.com/general/overview-dynamic-delivery.html">Livraison dynamique</a> , et vous hébergez des sous-titres avec nous <em>(sous-titres non distants)</em>, alors nous ferons en sorte que tout fonctionne automatiquement par magie (PTS doit être à zéro et nous nous assurerons qu'il l'est.)</p>

<p>Si votre compte est activé pour la livraison dynamique et que vous utilisez <strong><em>à distance</em></strong> sous-titres, vous devrez définir la valeur PTS sur zéro.</p>

<p>Par exemple, pour obtenir la valeur de décalage, vous pouvez procéder comme suit :</p>

<h3>Demande1 :</h3>

<p>Dans le terminal, récupérez une vidéo HLS et stockez-la dans un fichier local. Dans ce cas, nous le nommons <code translate="No">seg.ts</code>.</p>

<pre class="line-numbers">
<code class="language-http" translate="No">curl -o seg.ts "http://brightcove.vo.llnwd.net/v1/unsecured/media/4360108595001/201507/1154/4360341622001/4360108595001_4360341622001_s-1.ts?pubId=4360108595001&amp;videoId=4360283683001"</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="17-18"></code></p> -->

<h3>Demande2 :</h3>

<p>Ensuite, utilisez le <code translate="No">ffprobe</code> commande pour obtenir la valeur de décalage. <code translate="No">ffprobe</code> est un analyseur de flux multimédia, qui fait partie de la <a href="//ffmpeg.org/about.html">Cadre FFmpeg</a>. Vous devrez le télécharger et l'installer sur votre ordinateur.</p>

<pre class="line-numbers">
<code class="language-http" translate="No">ffprobe -show_frames seg.ts</code></pre>

<h3>Réponse:</h3>

<p>Votre réponse devrait ressembler à ceci :</p>

<pre class="line-numbers">
<code class="language-html" translate="No"><span class="bcls-highlight">pkt_pts=900000</span>
pkt_pts_time=10.000000
pkt_dts=900000
pkt_dts_time=10.000000</code></pre>
<!-- <p><code data-gist-id="d59006640cce4709fdc2" data-gist-line="21-24" data-gist-highlight-line="21" data-gist-hide-footer="true"></code></p> -->

<br/>
<aside class="bcls-aside bcls-aside--warning">L'ajout de l'en-tête X-TIMESTAMP-MAP peut entraîner des incohérences sur d'autres plates-formes, telles que les applications Windows Mobile. Assurez-vous de tester sur toutes les plates-formes après avoir ajouté l'en-tête de décalage. L'ajout de cette balise d'en-tête est une exigence de spécification HLS, et non un paramètre de spécification WebVTT.</aside>
</section>

<section class="bcls-section">
<h2 id="Best_practices">Les meilleures pratiques</h2>

<p>Les instructions suivantes devraient vous aider lors du développement de votre application avec des sous-titres.</p>

<h3>Durée du sous-titre</h3>

<p>Il est recommandé que la durée du sous-titre ne dépasse pas la durée de la vidéo. Cela empêchera l'affichage des sous-titres ou l'apparition d'une zone introuvable dans la barre de progression une fois la lecture vidéo terminée.</p>
</section>
</article>